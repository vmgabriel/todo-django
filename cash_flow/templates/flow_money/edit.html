{% extends 'content.html' %}
{% load static %}
{% load djmoney %}

{% block container %}
    <div class="container" style="margin-top: 3em;">
        <a href="{% url 'cash_flow:home_cash_flow'  %}">
            <i class="material-icons">arrow_back</i>
        </a>

        <div class="card-panel">
            <div class="row" style="display: inline-flex;">
                <h2>{% if mode == "Save" %}New{% else %}Edit{% endif %} Money Flow</h2>
            </div>

            <form method="post" class="col s12" style="padding-bottom: 2em;">
                {% csrf_token %}
                <div class="row">
                    <div class="input-field col s12">
                        {{ form.description }}
                        <label for="description">{{ form.description.label }}</label>
                        {% if form.description.errors %}
                            {% for error in form.description.errors %}
                                <p style="color: red">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                    <div class="input-field col s12">
                        {{ form.category }}
                        <label for="category">{{ form.category.label }}</label>
                        {% if form.category.errors %}
                            {% for error in form.category.errors %}
                                <p style="color: red">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                    <div class="input-field col s12">
                        {{ form.amount }}
                        <label for="amount">{{ form.amount.label }}</label>
                        {% if form.amount.errors %}
                            {% for error in form.amount.errors %}
                                <p style="color: red">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                    <div class="col s12">
                        <label for="date_flow">{{ form.date_flow.label }}</label>
                        {% if mode == "Save" %}
                        <input type="text" class="datepicker" name="date_flow" value="{{ form.date_flow.value }}">
                        {% else %}
                            <input type="text" class="datepicker" name="date_flow" value="{{ form.date_flow.value|date:'Y-m-d' }}">
                        {% endif %}
                        {% if form.date_flow.errors %}
                            {% for error in form.date_flow.errors %}
                                <p style="color: red">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="col s12 right-align">
                    {% if mode != "Save" %}
                        <a href="{% url 'cash_flow:money_delete' pk=object.pk %}" class="btn waves-effect waves-red btn-large red">
                            <i class="material-icons">delete</i>
                        </a>
                    {%  endif %}
                    <a href={% if mode == "Save" %}"{% url 'cash_flow:money'  %}"{% else %}"{% url 'cash_flow:money_edit' pk=object.pk  %}"{% endif %} class="btn waves-effect waves-red btn-large blue">
                        <i class="material-icons">cancel</i>
                    </a>
                    <button type="submit" class="waves-effect waves-light btn-large">
                        {% if mode == "Save" %}
                            <i class="material-icons">save</i>
                        {% else %}
                            <i class="material-icons">edit</i>
                        {% endif %}
                    </button>
                </div>
            </form>
        </div>
    </div>
{% endblock container %}

{% block javascript %}
document.addEventListener('DOMContentLoaded', () => {
    const elems = document.querySelectorAll('.datepicker');
    const instances = M.Datepicker.init(elems, {
        format: "yyyy-mm-dd",
    });
});
{% endblock javascript %}